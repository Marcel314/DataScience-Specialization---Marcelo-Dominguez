{
    "contents" : "# DataScience Specialization - R Programming\n# Assigment3 - Hospital Quality\n# by Marcelo Domínguez\n# @_marcelo_d \n\n\n# Configuration\n# - Setting packages and working directory\n# - Downloaded raw data and unzip to \"./in\" folder\nsetup <- function() {\n  cat(\"Setup\")\n  install.packages(\"downloader\")\n  library(downloader)\n  sapply(packages, require, character.only=TRUE, quietly=TRUE)\n  setwd(\"./\")\n  path = getwd()\n  path\n  url = \"https://d396qusza40orc.cloudfront.net/rprog%2Fdata%2FProgAssignment3-data.zip\"\n  datasetFile = \"assignment-dataset.zip\"\n  download(url, dest=datasetFile, mode=\"wb\") \n  if (file.exists(\"./in\")) {\n    unlink(\"./in\",recursive=TRUE,force=TRUE)\n  } else {\n    dir.create(\"./in\", showWarnings = FALSE, recursive = FALSE, mode = \"0777\")\n  }\n  unzip(datasetFile, exdir = \"./in\")\n  cat(\"Setup: ok\")\n}\n\n# Get outcome columnName\ngetOutcomeColumn <- function(outcome) {\n  if (outcome == \"heart attack\") {\n    outcome <- \"Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack\"\n  } else if (outcome == \"heart failure\") {\n    outcome <- \"Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure\"\n  } else if (outcome == \"pneumonia\") {\n    outcome <- \"Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia\"\n  }\n}\n\n# Function that reads csv file and returns a character vector with the name of the hospital that \n# has the best (lowest) 30-day mortality for the specified 'outcome' in that 'state'.\n# - hospital name = value of 'Hospital.Name' column\n# - outcomes = values “heart attack” “heart failure\" or “pneumonia”\n# - Hospitals that do not have data on a particular outcome should be excluded from the set of hospitals when deciding the rankings.\nbest <- function(state, outcome) {\n  \n  ## Read outcome data\n  measures = read.csv(\"./in/outcome-of-care-measures.csv\", colClasses = \"character\")\n  \n  ## Check that state and outcome are valid\n  if (!is.element(state,measures[,7])) {\n    stop(\"invalid state\")\n  }\n   \n  if (!is.element(outcome,c('heart attack','heart failure','pneumonia'))) {\n    stop(\"invalid outcome\")\n  }\n  \n  ## Return hospital name in that state with lowest 30-day death rate\n  \n  # outcome column name\n  outcomeColumn = getOutcomeColumn(outcome)\n  # measurements by given state\n  measures <- measures[measures$State==state,]\n  # measurements by given state and given outcome\n  measures[,outcomeColumn] <- suppressWarnings(as.numeric(measures[,outcomeColumn]))\n  measures <- measures[order(measures[outcomeColumn], measures$\"Hospital.Name\"),]\n  name = head(as.character(measures$\"Hospital.Name\"[!is.na(measures[outcomeColumn])]),1)\n  name\n}",
    "created" : 1427218897876.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "9|21|27|0|\n30|39|38|0|\n45|34|70|0|\n",
    "hash" : "2740800589",
    "id" : "DCE36AFF",
    "lastKnownWriteTime" : 1427407443,
    "path" : "~/Projects/datascience-specialization/GitHub-Repos/DS02-R-Programming/ProgrammingAssignment3/best.R",
    "project_path" : "best.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}